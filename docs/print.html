<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Automaton Manual</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="background.html"><strong aria-hidden="true">2.</strong> Background</a></li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">3.</strong> Installation</a></li><li class="chapter-item expanded "><a href="quickstart.html"><strong aria-hidden="true">4.</strong> QuickStart</a></li><li class="chapter-item expanded "><a href="api/index.html"><strong aria-hidden="true">5.</strong> API</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/automaton.html"><strong aria-hidden="true">5.1.</strong> Automaton</a></li><li class="chapter-item expanded "><a href="api/actions/index.html"><strong aria-hidden="true">5.2.</strong> Actions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="api/actions/remap.html"><strong aria-hidden="true">5.2.1.</strong> Remap</a></li><li class="chapter-item expanded "><a href="api/actions/redirect.html"><strong aria-hidden="true">5.2.2.</strong> Redirect</a></li><li class="chapter-item expanded "><a href="api/actions/hotkey.html"><strong aria-hidden="true">5.2.3.</strong> HotKey</a></li><li class="chapter-item expanded "><a href="api/actions/hotstring.html"><strong aria-hidden="true">5.2.4.</strong> HotString</a></li></ol></li><li class="chapter-item expanded "><a href="misc/index.html"><strong aria-hidden="true">5.3.</strong> Misc</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="misc/actionstring.html"><strong aria-hidden="true">5.3.1.</strong> ActionString</a></li><li class="chapter-item expanded "><a href="misc/macro.html"><strong aria-hidden="true">5.3.2.</strong> Macro</a></li><li class="chapter-item expanded "><a href="misc/peripheral.html"><strong aria-hidden="true">5.3.3.</strong> Peripheral</a></li></ol></li><li class="chapter-item expanded "><a href="internals/index.html"><strong aria-hidden="true">5.4.</strong> Internals</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="internals/action_emitter.html"><strong aria-hidden="true">5.4.1.</strong> ActionEmitter</a></li><li class="chapter-item expanded "><a href="internals/context.html"><strong aria-hidden="true">5.4.2.</strong> Context</a></li><li class="chapter-item expanded "><a href="internals/input_stream.html"><strong aria-hidden="true">5.4.3.</strong> InputStream</a></li><li class="chapter-item expanded "><a href="internals/constants.html"><strong aria-hidden="true">5.4.4.</strong> Constants</a></li><li class="chapter-item expanded "><a href="internals/input.html"><strong aria-hidden="true">5.4.5.</strong> Input</a></li><li class="chapter-item expanded "><a href="internals/testing.html"><strong aria-hidden="true">5.4.6.</strong> Testing</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Automaton Manual</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<h3 id="what-is-automaton"><a class="header" href="#what-is-automaton">What is Automaton?</a></h3>
<p>Automaton is a library that allows you to execute certain operations when certain inputs are given (via input devices connected to your computer). It can be used for almost all keyboard and mouse related projects, be it manipulating said devices, or for capturing their inputs. </p>
<p>As of yet, it provides a number of builtin methods for listening and capturing the input from your keyboards, allowing you to create of hotkeys, hotstrings, etc.</p>
<h3 id="how-does-it-work"><a class="header" href="#how-does-it-work">How does it work?</a></h3>
<p>It is meant to be a replacement for <a href="https://www.autohotkey.com/">AutoHotkey</a>, which does not work on Linux. It makes use of the Linux <a href="https://en.wikipedia.org/wiki/Evdev">evdev</a> interface and, as such, requires root privileges. Automaton is focused on being the perfect tool for the creation of macros and other keyboard-related gimmicks for Linux.</p>
<h3 id="the-automaton-project"><a class="header" href="#the-automaton-project">The Automaton Project</a></h3>
<p>Automaton is divided into two parts: the library itself, which is written in <a href="https://www.python.org">Python</a>, and the <code>autumn</code> language, which makes use of the library to allow simple tasks to be done with relative ease (currently not implemented). The latter is similar to the AutoHotkey language, although syntactically distinct. </p>
<p>The library itself can be used without the <code>autumn</code> language (a feature that AutoHotKey lacks).</p>
<h3 id="why-should-i-use-it"><a class="header" href="#why-should-i-use-it">Why should I use it?</a></h3>
<p>The unavailability of AutoHotKey on Linux was indubitably the impetus for this project. Sure, there many other libraries/applications in Linux that provide similar features (notable examples include <a href="https://github.com/boppreh/keyboard/">keyboard</a> and <a href="https://github.com/boppreh/mouse">mouse</a>, <a href="https://github.com/moses-palmer/pynput">pynput</a>, and <a href="https://github.com/autokey/autokey">AutoKey</a>), however Automaton, unlike these libraries, offers the most feature parity with AutoHotKey on Linux, being directly based on its design and structure after years of use on Windows. With Automaton, you'll be able to do everything you could with Linux in roughly the same amount of code, though their syntaxes differ.</p>
<p>Here's a neat table that summarizes the pros and cons of Automaton, because tables <em>never</em> lie:</p>
<h4 id="pros"><a class="header" href="#pros">Pros:</a></h4>
<ul>
<li>Can be used across Linux. Not <em>just</em> x11, or KDE, <strong>all</strong> of Linux.</li>
<li>Almost complete feature parity with AutoHotkey.</li>
<li>Supports unicode ä”„ (looking at you, keyboard)</li>
<li>Supports key suppression.</li>
</ul>
<h4 id="cons"><a class="header" href="#cons">Cons:</a></h4>
<ul>
<li>Does not work on Windows.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="background"><a class="header" href="#background">Background</a></h1>
<p>Before you can start using automaton, you'll need a bit of a lesson. Linux uses an interface for communicating between the keyboard and the kernel, known as <a href="https://en.wikipedia.org/wiki/Evdev">evdev</a>. In Linux, pretty much everything is a file, and input device interfaces are no exception.</p>
<p>In the directory <code>/dev/input/</code>, there are a number of files starting with <code>event0</code>.</p>
<pre><code class="language-bash">$ ls /dev/input/
by-id/    event0  event10  event12  event2  event4  event6  event8  mice    mouse1  mouse3
by-path/  event1  event11  event13  event3  event5  event7  event9  mouse0  mouse2
</code></pre>
<p>Automaton uses these files to function, but you (as the user) must specify what device you want to capture inputs from. For example, my keyboard and mouse correspond to <code>/dev/input/event5</code> and <code>/dev/input/event4</code>.</p>
<p>Keep in mind that these paths may change everytime the device is disconnected and reconnected (such as when powering off). To figure out which of these files represent your chosen devices, refer to the <a href="/src/installation.html">next page</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<p>Automaton is hosted on <a href="https://www.github.com/Abdul-Muiz-Iqbal/Automaton">GitHub</a> as well as <a href="https://pypi.org/project/automaton-linux/">PyPI</a>. It supports Python &gt;= 3.8. The preferred method of installation is via <code>pip</code>. As Automaton requires root privileges in order to function properly, the package must be installed as root as well:</p>
<pre><code>$ sudo pip install automaton-linux
</code></pre>
<p>Automaton has a few dependencies, but if an error occurs when building <code>evdev</code>, make sure that you have the Python headers installed. On Debian, this is as simple as:</p>
<pre><code>$ sudo apt-get install python3-dev
</code></pre>
<p>To make sure that it is working properly, open a Python repl <strong>as root</strong> and run the following:</p>
<pre><code class="language-python3">from automaton import *

for device in Automaton.find_devices():
    print(device)
</code></pre>
<p>This should output each device in the format, <code>name :: path</code>. These paths may change when a device reconnects, however its name will remain the same.</p>
<p>Find the path of your keyboard and mouse, then proceed to the <a href="/src/quickstart.html">next page</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quickstart"><a class="header" href="#quickstart">QuickStart</a></h1>
<p>A simple Automaton app might look like this:</p>
<pre><code>from automaton import *

app = Automaton.new(devices = [
    '/dev/input/event5',
    '/dev/input/event6'
])

app.remap(Key.A, Key.K)

app.run()
</code></pre>
<p>Alright, so what's happening here?</p>
<p>On line 1, we import everything that we need from Automaton, which is usually everything and the kitchen sink.</p>
<p>On line 3, we instantiate a new Automaton object. We pass to it a keyword argument, <code>devices</code>. This is a list of paths to the devices that we want to monitor or control. Keep in mind, Automaton can only monitor events that the devices are capable of executing.</p>
<p>On line 8, we call the remap method, which takes two arguments, <code>src</code> and <code>dest</code>. All it does is remap the <code>src</code> key to the <code>dest</code> key. If you were to press the <code>A</code> key while this script is running, you would find that instead of <code>a</code> being typed, a nice fat <code>k</code> is typed instead. </p>
<p>Finally, on line 10, we call the <code>run</code> method, which is a blocking call. Only after this method has been called, will the monitoring (and thus the remapping)start. Conversely, controlling a device can be done at any time after the Automaton object has been instantiated.</p>
<p>While this script is running, if you were to in a separate repl do <code>Automaton.find_devices()</code>, you will find a new device, named <code>Automaton</code>. This is a UInput device that is created by Automaton. You don't need to care about this much, and the details of how it works are explained in the Internals chapter.</p>
<p>With that simple app out of the way, here are some more examples of automaton apps:</p>
<h4 id="do-something-when-a-hotkey-is-pressed"><a class="header" href="#do-something-when-a-hotkey-is-pressed">Do something when a hotkey is pressed</a></h4>
<pre><code>@app.on([Key.LCtrl, Key.LShift, Key.M])
def type_hello():
    app.type(&quot;Hello, John!&quot;)
</code></pre>
<h4 id="text-replacement"><a class="header" href="#text-replacement">Text replacement</a></h4>
<pre><code>from datetime import datetime

@app.on(&quot;:date&quot;)
def insert_date():
    return datetime.now().strftime(&quot;%Y-%m-%d %H:%M&quot;)
</code></pre>
<p>As you can see, the <code>on()</code> method is overloaded to either take a list of keys, or a string. This is parsed into a hotkey and hotstring, respectively. </p>
<p>Another important point is that we are returning a string from the function. This is the replacement text that will be written instead of the hotstring.</p>
<p><strong>Note</strong>: You <em>can</em> return a string in a hotkey invocation as well, and it does exactly what you'd expect (it is also written). Therefore, in the hotkey example, we could have just returned the string <code>&quot;Hello, John!&quot;</code></p>
<h4 id="do-something-when-a-hotstring-is-typed"><a class="header" href="#do-something-when-a-hotstring-is-typed">Do something when a hotstring is typed</a></h4>
<pre><code>import os

@app.on(&quot;:shutdown&quot;)
def shutdown():
    os.system(&quot;shutdown -P&quot;)
</code></pre>
<h4 id="remapping-a-key-to-a-mouse-button"><a class="header" href="#remapping-a-key-to-a-mouse-button">Remapping a key to a mouse button</a></h4>
<pre><code>app.remap(Key.Numpad4, Button.LeftButton)
</code></pre>
<h4 id="actions-that-only-works-if-certain-condition-are-true"><a class="header" href="#actions-that-only-works-if-certain-condition-are-true">Actions that only works if certain condition are true:</a></h4>
<pre><code># Only work on Fridays the 13th

from datetime import datetime as dt
ominous = lambda: dt.now().weekday() == 4 and dt.now().day == 13

app.remap(Key.A, Key.K, when=ominous)
</code></pre>
<p>Both <code>app.on</code> and <code>app.remap</code> have a keyword argument called <code>when</code>. It takes a callable that should return a Boolean value. The action will run only when the returned value is true. In this example, all As will be replaced with Ks only on Fridays the 13th.</p>
<h4 id="actions-that-only-works-if-the-requirements-are-met-by-a-specific-device"><a class="header" href="#actions-that-only-works-if-the-requirements-are-met-by-a-specific-device">Actions that only works if the requirements are met by a specific device</a></h4>
<p>Say you have two keyboards connected, one being your daily driver, and the other your dedicated macro keyboard. You want your second keyboard and only your second keyboard to do something different when the A key is pressed. What do you do? This!</p>
<pre><code># Assume /dev/input/event5 is your main keyboard...
# and /dev/input/event6 is your macro keyboard.

app = Automaton.new(devices = [
    '/dev/input/event5',
    '/dev/input/event6',
    # We don't care about the mouse here.
])

app.on([Key.A], from_device = '/dev/input/event6')
def macro_keyboard_only():
    print(&quot;Only available on MacroKeyboard!&quot;)
</code></pre>
<h4 id="configuring-the-behaviour-of-certain-actions"><a class="header" href="#configuring-the-behaviour-of-certain-actions">Configuring the behaviour of certain actions</a></h4>
<p>If you've ever used AutoHotkey, you'll probably know that you can specify if a hotstring replaces the trigger text or not. There are many other options like that too, and Automaton has them all!</p>
<pre><code>app.on(&quot;:date&quot;, options = [
    # Just one of many. See Api/Actions/HotString
    HotStringOptions.PreventAutoBackspace
])
def date():
    return &quot;No Replacement :)&quot;
</code></pre>
<p>Pretty much all actions besides <code>Redirect</code> have options.</p>
<p>Another thing you can configure in AutoHotkey would be which keys can actually trigger the hotstring after the trigger text has been typed. Guess who can do that as well:</p>
<pre><code>app.on(&quot;:date&quot;, triggers = [Key.Space, Key.K])
def date():
    return &quot;15 March 2022&quot;
</code></pre>
<p>By default, the triggers keys are the constant <code>HOTSTRING_TRIGGERS</code> (see Api/Internals/Constants)</p>
<h4 id="recording-a-macro-then-playing-it"><a class="header" href="#recording-a-macro-then-playing-it">Recording a macro, then playing it.</a></h4>
<pre><code>macro: Macro = app.record_until(lambda: app.device.is_pressed(Key.Esc))

speed = 1.5 # Speed at which to perform the actions.
macro.play(speed)
</code></pre>
<p>Note that macros are currently experimental.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="api"><a class="header" href="#api">Api</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="automaton"><a class="header" href="#automaton">Automaton</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="actions"><a class="header" href="#actions">Actions</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="remap"><a class="header" href="#remap">Remap</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="redirect"><a class="header" href="#redirect">Redirect</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hotkey"><a class="header" href="#hotkey">HotKey</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hotstring"><a class="header" href="#hotstring">HotString</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="misc"><a class="header" href="#misc">Misc</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="actionstring"><a class="header" href="#actionstring">ActionString</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="macro"><a class="header" href="#macro">Macro</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="peripheral"><a class="header" href="#peripheral">Peripheral</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="internals"><a class="header" href="#internals">Internals</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="actionemitter"><a class="header" href="#actionemitter">ActionEmitter</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="context"><a class="header" href="#context">Context</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inputstream"><a class="header" href="#inputstream">InputStream</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="constants"><a class="header" href="#constants">Constants</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="input"><a class="header" href="#input">Input</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="testing"><a class="header" href="#testing">Testing</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
